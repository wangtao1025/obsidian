# Python 语法手册：数据处理

← [语法手册总览](/python/python语法手册) | 下一章见总览

---

## 八、数据处理

核心直觉： 算法是灵魂，单位是底线。
### 8.1 进制转换的“万能公式”

在 Python 中，处理进制转换只需记住一个中转站：**十进制**。

- **第一步：统一化**：利用 `int(str, base)` 将源数据（2-16进制）全部吞掉，转化成 Python 内部的十进制整数。

- **第二步：多样化**：
  
  - 如果转回 2/8/16 进制：直接使用内置函数 `bin()` / `oct()` / `hex()`。
  
  - 如果转成自定义进制（如 7 进制）：使用**循环取余法**（不断用 `//` 和 `%` 剥离每一位数字）。

```Python
# 核心逻辑示例 (十进制作为中转)
decimal_val = int("FF", 16)      # FF -> 255
binary_str = bin(decimal_val)    # 255 -> '0b11111111'
```

### 8.2 存储单位格式化 (Human Readable)

为了让文件大小变得“人类可读”，我们需要在 **1024 进制**（KiB/MiB 系列）下进行单位降级。

- **核心算法**：使用 `while` 循环判定。只要数字 $\ge 1024$，就除以 1024.0 并且将单位列表索引 `+1`。

- **单位阶梯**：`['B', 'KiB', 'MiB', 'GiB', 'TiB']`。

- **全栈应用**：后端返回原始字节数 `1536`，前端通过此算法显示 `1.50 KiB`。

### 8.3 网络下载时间计算 (The 8-Bit Trap)

这是最容易被面试官抓住的细节陷阱：**大 B (Byte) 与 小 b (bit)**。

- **换算底线**：文件大小通常以 **MB** (Megabyte) 存储，而带宽速度以 **Mbps** (Megabit per second) 计算。

- **换算关键**：$1\text{ Byte} = 8\text{ bits}$。

- **避坑公式**：$\text{下载秒数} = (\text{文件 MB} \times 8) \div \text{带宽 Mbps}$。

- **逻辑分支**：根据总秒数判断输出单位（秒/分钟/小时），并使用 f-string 控制小数位数（如 `{val:.1f}`）。

### 8.4 健壮性检查 (Defensive Programming)

作为“谨慎的开发者”，函数的第一行永远应该是**边界检查**：

- **进制范围**：必须在 2 到 16 之间。

- **数值合法性**：文件大小不能为负数，带宽必须大于 0。
